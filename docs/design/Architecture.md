# 架构设计文档

本文档详细描述问卷星自动化系统的架构设计。

## 1. 总体架构

问卷星自动化系统采用前后端分离的架构设计，主要由以下几个部分组成：

1. **前端层**: 提供用户界面，使用Vue.js构建
2. **后端API层**: 提供RESTful API服务，使用Flask实现
3. **核心功能层**: 包含问卷解析、LLM生成、提交等核心功能模块
4. **数据存储层**: 使用文件系统存储数据，主要是JSON格式文件

各层之间通过明确的接口进行通信，确保模块的低耦合高内聚。

![系统架构图](../../Diagrams/Architecture/system_architecture.png)

## 2. 部署架构

系统支持两种部署方式：

1. **Docker容器化部署**:
   - 前端容器: Nginx + Vue.js静态文件
   - 后端容器: Gunicorn + Flask
   - 通过Docker Compose编排

2. **传统部署**:
   - 前端: 静态文件部署到Web服务器
   - 后端: 使用Gunicorn或直接使用Flask开发服务器

![部署架构图](../../Diagrams/Architecture/deployment_architecture.png)

## 3. 数据流架构

系统主要数据流如下：

1. 用户输入问卷URL → 系统解析问卷结构 → 存储问卷数据
2. 用户创建提交任务 → 系统生成答案 → 优化答案 → 提交到问卷星 → 返回结果
3. 用户查询任务状态 → 系统读取任务数据 → 返回任务状态和进度

![数据流图](../../Diagrams/Flowcharts/data_flow.png)

## 4. 模块组织结构

### 4.1 后端模块组织

```
backend/
├── app.py                # 应用入口点
├── config.py             # 配置文件
├── core/                 # 核心功能模块
│   ├── parser.py         # 问卷解析
│   ├── wjx.py            # 问卷星交互
│   ├── optimizer.py      # 答案优化
│   └── llm_generator.py  # 答案生成
├── routes/               # API路由
├── services/             # 业务服务
└── utils/                # 工具类
```

### 4.2 前端模块组织

```
frontend/
├── src/
│   ├── components/       # 通用组件
│   ├── views/            # 页面视图
│   ├── router/           # 路由配置
│   └── api/              # API调用
├── public/               # 静态资源
└── index.html            # 入口页面
```

## 5. 系统扩展性设计

- **模块化架构**: 核心功能模块化，便于扩展和维护
- **插件系统**: 预留LLM提供商和代理服务的可插拔接口
- **配置驱动**: 关键参数可通过配置调整，无需修改代码

## 6. 技术债务和限制

- 文件系统存储在大规模使用时可能会有性能问题
- 缺乏完善的用户认证和权限控制
- 依赖第三方LLM服务的可用性和稳定性
- 问卷星平台可能更新接口或增加防护措施 